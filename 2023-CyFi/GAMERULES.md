# Entelect Challenge 2023: Cy-Fi ğŸ† Release 2023.2.4

---
>### _NB:_ Change log 
>
>* Bug fixesğŸ›
>   - infinite jumping
>   - world generation not deterministic 
> * Features ğŸ§ª
>   - [antagonistic action](#steal)
>   - [radar](#radar)
>   - [hazard implementation](#game-objects)
>   - max ticks (game ends after a max amount of ticks is reached)
>
> * Reported Bugs:
>   - When falling and move into a solid, bot sticks to solid
>   - When on a corner/vertex of a solid bot does not fall
>

---

## The Game

**Cy-Fi is a sci-fi/cyberpunk/lo-fi platformer and the official game for the Entelect Challenge 2023. ğŸƒâ€â™€ï¸

The world of Cy-Fi consists of four procedurally generated dimensions. Each dimension has a unique theme and its own approach to world generation. As players progress through each dimension, the world size increases.

To generate the world, several routes (`paths`) are first created that traverse the map. Then it is filled with random noise to form cave-like structures. Ladders and paths are then added to create multiple pathways to explore the level. Bots must collect reality-distorting crystals (`Collectibles`) to progress to the next level.

However, players must be wary of other bots in the world!

## Contents
- [Entelect Challenge 2023: Cy-Fi ğŸ†](#entelect-challenge-2023-cyfi-)
  - [The Game](#the-game)
  - [Contents](#contents)
  - [General](#general)
  - [Rules](#rules)
  - [Game Ticks](#game-ticks)
  - [Heroes](#heroes)
  - [The Map](#the-map)
  - [Visibility](#visibility)
  - [Radar](#radar)
  - [Game Objects](#game-objects)
  - [The Commands](#the-commands)
    - [Command: UP](#command-up)
    - [Command: Down](#command-down)
    - [Command: RIGHT/LEFT](#command-rightleft)
    - [Command: UPRIGHT/UPLEFT](#command-uprightupleft)
    - [Command: DOWNRIGHT/DOWNLEFT](#command-downrightdownleft)
    - [Command: DIGDOWN/DIGRIGHT/DIGLEFT](#command-digdowndigrightdigleft)
    - [Command: STEAL](#command-steal)
    - [Command: RADAR](#command-radar)
  - [Command Structure](#command-structure)
  - [GAME TICK PAYLOAD](#game-tick-payload)
  - [END GAME](#endgame)
  - [SCORING](#scoring)
  - [THE MATH](#the-math)
    - [Radar Distance Calculation](#radar-distance-calculation)

---

## General

ğŸ“’ _Note: All configuration is subject to change while we balance the game. For the latest configurations please navigate to `2023-CyFi/Cy-Fi` for `appsettings.json`, `appsettings.Development.json` and `appsettings.Production.json`. You can also find additional configurations in the subfolder `Settings`, where `GameSettings` and `MapSettings` are located._

---
## Rules

In each level, heroes (`bots`) must collect several `Collectibles`. Once they have the required number, they can progress to the next `Level`.

There are four `Levels` in total, and the first hero to collect enough `Collectibles` in the final round wins. **It's a race to the finish!**

The number of `Collectibles` available in each level decreases.  

When a player collects a `Collectible`, it is removed from the world and is no longer available to the other heroes.

Heroes can `Steal` `Collectibles` from other heroes. The amount of `Collectibles` a hero can steal is proportional to the number of collectibles the target hero has. Heroes with more `Collectibles` cannot `Steal` from heroes with fewer `Collectibles` - try and go for the heroes with the most!

Heroes can also `Dig` through the terrainto receive a `Collectible` after digging a certain number of tiles.

---
## Game Ticks

Cy-Fi is a real time game that utilises `Ticks`, a unit in time to keep track of the game.

ğŸ“’ _Note: only 3 commands are processed per tick and the slowest of the four heroes to send their `command`, will have their `command` processed first in the next tick_

---

## Heroes

Four Heroes (`bots`) will be placed into the map together, and have to race to finish the game! Acquiring `Collectibles` will get you to the next `Level`. `Stealing` is legal!

## The Map

The world of Cy-Fi is divded into four procedurally generated dimensions. The four maps are generated from unique seeds. Each dimension has its own theme, and its own spin on the world generation, with each dimension getting larger.

The worlds are generated by first generating several "paths" through the map, and are then filled in with random noise (`Solid`) to form cave-like structures, which are then globbed together into solid walls. Ladders and paths are generated to form multiple pathways to traverse the level. Collectibles are then scattered around the map for the heroes to collect and hazards are placed for heroes to avoid.

A generated image of the map: with `Solid` as "brown", and interconnecting horizontal line represent `platforms`, vertical line `ladders` and the dots on the path represent `collectibles` "black" and `hazards` "red"

![full map](./Assests/full_map.png)

---

## Visibility

The heroes can only see a certain distance around themselves. `16` tiles vertically and `10` horizontally.

_A generated view of the Hero's point of view (`HeroWindow`):  hero(`bot`) "pink", `Solid` "brown", `Ladders` "blue", `Platforms` green, `Air` "white", `Collectibles` "black" and `Hazards` "red"_
![Hero Window](./Assests/hero_windo.png)

## Radar

The radar can be used by a player to track the location of an opponent. The exact location will not be specified, only the general direction and approximate distance will be given. See [Command:RADAR](#command-radar)

ğŸ“’ _Note: Hero's can only see the location of an opponent with more collectables than themselves. So watch your back!_

## Game Objects

The map has the following tiles (pixels) :

- `Air` - 0 - Normal, open, breathable air.
- `Solid` - 1 - A solid object, the hero can only collide with this object. No interactions.
- `Collectible` - 2 - Collectibles are what you need to collect... just try to get the most.
- `Hazard`- 3 - When the hero interacts with a hazard, the Hero will be teleported back to the starting point of the level! So... don't
- `Platform` - 4 - Normal, walkable platform.
- `Ladder` -  5 - Want to go up? Jump. Want to go higher? Use a ladder.
- `Opponent`- 6 - opposing players on the map

--
## The Commands

Players may traverse the map via basic movement, `climbing`, and `jumping`. `Digging` will also clear out terrain (and give you `collectibles`), so you can use that to your advantage.

ğŸ“’ _Note: A player has gravity and can therefore fall back to the ground if suspended in the `Air`. The player will stop falling when a `Solid` or `Platform` is encountered. Even though a player can fall, they cannot build momentum (speed) while falling or running. However while falling a player can still maneuver through `Air`_.

The Commands are as follows:

* `UP` - 1
* `DOWN`- 2
* `LEFT` - 3
* `RIGHT` - 4
* `UPLEFT` - 5
* `UPRIGHT` - 6
* `DOWNLEFT` - 7
* `DOWNRIGHT` - 8
* `DIGDOWN` - 9
* `DIGLEFT` - 10
* `DIGRIGHT` - 11
* `STEAL` - 12
* `RADAR` - 13

### Command: UP

Allows the player to jump in open `Air` and on top of `Platforms` and, if positioned correctly, climb on `Ladders`.

Cannot jump when obstruction is encountered i.e `Solid`

---

### Command: Down

Allows the player to move one square down

---
### Command: RIGHT/LEFT

Allows the player to move one tile in either direction through `Air`, `Ladder`

Cannot move when obstructed by `Solid`

ğŸ“’ _Note: Movement speed is fixed_

---

### Command: UPRIGHT/UPLEFT 

Allows player to jump diagonal in open `Air`, on to `Platforms` and more easily jump on to `Ladders`

Cannot move when obstructed by `Solid`

---
### Command: DOWNRIGHT/DOWNLEFT

Allows player to move diagonally down in open `Air`, on to `Platforms` and more easily jump on to `Ladders`

Cannot move when obstructed by `Solid`

---
### Command: DIGDOWN/DIGRIGHT/DIGLEFT


Players are able to dig through `Solid` in the specified directions.

ğŸ“’ _Note: Digging though a certain amount of solid will earn you a collectable!_

---
### Command: STEAL

In this universe crime is legal ğŸ˜ˆ. Hero's are allowed to steal `collectables` from one another. They will get a percentage of the player's wealth 

ğŸ“’ _Note: Heros can only steal from opponents with more collectables than themselves - not all heros wear capes_ğŸ¦¸ğŸ¦¸â€â™‚ï¸ğŸ¦¹ğŸ¦¹

---
### Command: RADAR

Stealing is all well and good but if you don't know where the opponent is then what's the point. Thankfully Radar has your back ğŸ’ª

Heros can use this ability to locate their opponents 

ğŸ“’ _Note: As previously stated: Hero's can only see the location of an opponent with more collectables than themselves. So watch your back!_

---
## Command Structure

The command is sent with the following structure:

```json
{
    "Action" : 1,                                    // UP action type - int
    "BotId" : "410d392c-ecf5-43b9-a228-299c0a8d224a" // Bot ID - string/UUID/GUID
}
```

## GAME TICK PAYLOAD
After every `Tick` the `runnerHub` will send a `BotStateDTO` response.

This will consist of the following values:
 - `CurrentLevel` - Current level your hero is on
 - `ConnectionId` - Your connectionId
 - `Collected` - Number of collectables your hero has collected
 - `ElapsedTime` - Time elapsed since game started
 - `HeroWindow` - The number of tiles a hero can view around themselves
 - `X` - Hero's current x position
  - `Y` - Hero's current y position
  - `RadarData` - The general location of an opponent (contains the direction and an estimate of the distance relative to the player)

Example payload

```
Bot State DTO
currentLevel :      0
connectionId :      spxaVtkFvQg6rTZas_VEQg
collected:          1
elapsedTime:        -738627:6:15:28.4138411
hero Window:
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 4, 2, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 2, 0, 0, 0, 0, 0, 0, 0, 0, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 5, 2, 5, 5, 5, 5, 4, 0, 0, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 5, 5, 5, 0, 0, 0, 0, 0, 4, 0, 0, 1]
                    [1, 1, 1, 1, 1, 1, 1, 0, 4, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 4, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5, 5]
                    [1, 1, 1, 1, 1, 1, 1, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 2, 1, 1, 1, 1, 0, 1, 1, 1, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 4, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0]
                    [1, 1, 1, 1, 1, 1, 1, 0, 0, 5, 5, 0, 0, 0, 0, 0, 1, 1, 1, 0]

X:                  24
Y:                  12
RadarData:          [
                      {
                        8,                    //DOWNRIGHT
                        4                     //With-in 75% of the total range 
                      },
                    ...
                    ]
```


ğŸ“’ _Note: Your hero is not added to the `HeroWindow`. Since they are in they are in the center, they are easy to calculate.\
The hero takes up 4 tiles to make a square._

## ENDGAME
When a hero completes `level` 4, the game ends and that hero is the winner. Subsequent heroes to finish level 4 come in second, third and fourth.

---

## SCORING 

Hero (`Bots`) get scores based on the amount of `collectibles` obtained. The hero that surpasses `level` four will gain extra points

---

## THE MATH

### Radar Distance Calculation

The distance between the hero and the opponent is calculated. The distance is then divided by the `RadarRange` (The rage of the hero's radar) to get the `PercentageDistance`

```
 percentageDistance = distance/radarRange * 100

```

A numeric value is then assigned based on the `PercentageDistance` please see the following ğŸ‘‡

```c
            if (percentageDistance > 100)
                return 0;
            else if (percentageDistance > 75)
                return 4;
            else if (percentageDistance > 50)
                return 3;
            else if (percentageDistance > 25)
                return 2;
            else
                return 1;
``` 

ğŸ“’ _Note: This is meant to give a general idea of the opponents location._


